# 01-OpenClaw入门指南

## 目录
- [项目简介](#项目简介)
- [核心概念](#核心概念)
- [技术栈](#技术栈)
- [快速开始](#快速开始)
- [代码结构](#代码结构)
- [学习路径](#学习路径)

## 项目简介

OpenClaw是一个**个人AI助手**，运行在你自己的设备上。它通过你已经在使用的渠道(WhatsApp、Telegram、Slack、Discord、Google Chat、Signal、iMessage、Microsoft Teams等)与你交互,并提供语音和对话功能。

### 项目起源

OpenClaw经历了多次演变：
- Warelay → Clawdbot → Moltbot → OpenClaw

这个演进反映了项目从简单聊天机器人到功能完整的AI助手的成长过程。

### 核心目标

- **本地优先** - 在你的设备上运行,尊重隐私和安全
- **多渠道集成** - 支持主流消息平台
- **强大工具** - 浏览器控制、Canvas、节点等
- **可扩展** - 通过插件和技能系统扩展

## 核心概念

### Gateway(网关)

Gateway是OpenClaw的核心控制平面,通过WebSocket提供统一的API:

```
Channels → Gateway ←→ WebSocket控制平面
                ↓
        Clients (CLI, Web, Apps, Nodes)
```

**关键特性:**
- WebSocket服务器(ws://127.0.0.1:18789)
- 会话管理
- 工具执行
- 事件处理
- 配置管理

### Session(会话)

每个对话实例都是一个Session,具有独立的:
- 上下文和历史
- 配置和模型选择
- 工具权限
- 激活模式

**Session类型:**
- `main` - 直接对话,完整权限
- `group` - 群组对话,受限权限
- `dm` - 私信对话,配对机制

### Agent(代理)

Agent是AI执行引擎,基于Pi运行时:
- RPC模式通信
- 流式响应
- 工具调用
- 子Agent支持

### Channels(渠道)

Channels是消息平台的抽象层:
- **WhatsApp** - 使用Baileys库
- **Telegram** - 使用grammY库
- **Slack** - 使用Bolt框架
- **Discord** - 使用discord.js
- **Google Chat** - 使用Chat API
- **Signal** - 使用signal-cli
- **iMessage** - BlueBubbles或legacy imsg
- **Microsoft Teams** - 通过扩展实现

### Tools(工具)

工具是Agent可执行的操作:
- `bash` - 命令执行
- `browser` - 浏览器控制
- `canvas` - 可视化工作区
- `nodes` - 设备节点操作
- `sessions_*` - 会话间通信

## 技术栈

### 运行时

- **Node.js** ≥22.12.0 - 核心运行时
- **TypeScript** - 主要开发语言
- **pnpm** - 包管理器

### 核心依赖

```json
{
  "@agentclientprotocol/sdk": "0.14.1",  // Agent通信协议
  "@mariozechner/pi-agent-core": "0.54.1",  // Pi代理核心
  "@mariozechner/pi-ai": "0.54.1",       // AI模型接口
  "@mariozechner/pi-coding-agent": "0.54.1", // 编码能力
  "express": "^5.2.1",                   // Web服务器
  "ws": "^8.19.0"                      // WebSocket
  "zod": "^4.3.6"                       // 验证
}
```

### 渠道库

```json
{
  "@whiskeysockets/baileys": "7.0.0-rc.9",  // WhatsApp
  "grammy": "^1.40.0",                 // Telegram
  "@slack/bolt": "^4.6.0",             // Slack
  "discord.js": "discord-api-types@^0.38.40",  // Discord
}
```

## 快速开始

### 安装

```bash
npm install -g openclaw@latest
# 或
pnpm add -g openclaw@latest
```

### 初始化

```bash
openclaw onboard --install-daemon
```

### 运行Gateway

```bash
openclaw gateway --port 18789 --verbose
```

### 发送消息

```bash
# 发送到WhatsApp
openclaw message send --to +1234567890 --message "Hello"

# 与Agent对话
openclaw agent --message "Ship checklist" --thinking high
```

## 代码结构

### 顶层目录

```
openclaw/
├── src/              # 主要源代码
├── test/            # 测试文件
├── docs/            # 文档
├── extensions/       # 扩展(渠道插件)
├── apps/            # 应用(macOS, iOS, Android)
├── ui/              # Web UI
├── scripts/          # 构建和工具脚本
└── package.json      # 项目配置
```

### src/目录结构

```
src/
├── gateway/          # Gateway服务器核心
├── agents/           # Agent运行时逻辑
├── channels/         # 渠道实现
├── plugins/          # 插件系统
├── config/           # 配置管理
├── cli/              # 命令行界面
├── browser/          # 浏览器控制
├── canvas-host/      # Canvas主机
├── memory/           # 内存系统
├── sessions/         # 会话存储
├── security/         # 安全机制
└── utils/            # 工具函数
```

## 学习路径

### 阶段1: 理解基础(1-2天)

1. 阅读[02-架构总览.md](./02-架构总览.md)
2. 理解Gateway-Session-Agent关系
3. 运行本地实例
4. 通过CLI发送第一条消息

### 阶段2: 深入核心(3-5天)

1. 学习[03-Gateway核心.md](./03-Gateway核心.md)
2. 理解WebSocket协议
3. 研究会话管理机制
4. 探索工具调用流程

### 阶段3: 渠道集成(2-3天)

1. 学习[04-Channels系统.md](./04-Channels系统.md)
2. 理解渠道抽象接口
3. 研究具体渠道实现(如Telegram)
4. 添加自定义渠道

### 阶段4: Agent运行时(3-5天)

1. 学习[05-Agent运行时.md](./05-Agent运行时.md)
2. 理解Pi协议集成
3. 研究工具调用机制
4. 探索流式响应处理

### 阶段5: 扩展开发(5-7天)

1. 学习[06-插件系统.md](./06-插件系统.md)
2. 理解Plugin SDK
3. 创建自定义插件
4. 开发自定义技能

## 开发环境设置

### 前置要求

- Node.js 22.12.0+
- pnpm 10.23.0+
- Git

### 从源码构建

```bash
git clone https://github.com/openclaw/openclaw.git
cd openclaw

pnpm install
pnpm ui:build
pnpm build

# 运行开发模式
pnpm openclaw gateway --dev
```

### 运行测试

```bash
# 所有测试
pnpm test

# 单元测试
pnpm test:fast

# 覆盖率
pnpm test:coverage

# E2E测试
pnpm test:e2e
```

## 代码质量

### 类型检查

```bash
pnpm tsgo
```

### Linting

```bash
# 检查
pnpm check

# 自动修复
pnpm lint:fix
```

### 格式化

```bash
# 检查
pnpm format:check

# 自动修复
pnpm format:fix
```

## 社区资源

### 官方资源

- **网站**: https://openclaw.ai
- **文档**: https://docs.openclaw.ai
- **Discord**: https://discord.gg/clawd
- **GitHub**: https://github.com/openclaw/openclaw

### 贡献

OpenClaw欢迎社区贡献!查看[CONTRIBUTING.md](../CONTRIBUTING.md)了解详细信息。

AI辅助的PR受到欢迎 - 只需在PR标题或描述中标记即可。

## 下一步

继续阅读以下文档深入了解各个模块:

1. [02-架构总览.md](./02-架构总览.md) - 理解整体设计
2. [03-Gateway核心.md](./03-Gateway核心.md) - 学习Gateway实现
3. [04-Channels系统.md](./04-Channels系统.md) - 了解渠道集成
4. [05-Agent运行时.md](./05-Agent运行时.md) - 深入Agent机制

---

**注意**: 本文档帮助你快速入门OpenClaw项目。建议按照学习路径循序渐进,每学完一个模块都动手实践。
